{"version":3,"file":"static/webpack/static/development/pages/sell.js.e63144c773d5b19fa6bb.hot-update.js","sources":["webpack:///./components/CreateItem.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { Mutation } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport Router from 'next/router';\nimport Form from './styles/Form';\nimport formatMoney from '../lib/formatMoney';\nimport Error from './ErrorMessage';\n\nconst CREATE_ITEM_MUTATION = gql`\n  mutation CREATE_ITEM_MUTATION(\n    $title: String!\n    $description: String!\n    $price: Int!\n    $image: String\n    $largeImage: String\n  ){\n    createItem(\n      title: $title\n      description: $description\n      price: $price\n      image: $image\n      largeImage: $largeImage\n    ){\n      id\n    }\n  }\n`;\n\nclass CreateItem extends Component {\n  state={\n    title: 'cool shoes',\n    description: 'I love those shoes',\n    image: 'dog.jp',\n    largeImage: 'large-dog.jpg',\n    price: 5000\n  }\n\n  \n  handleChange = event => {\n    const { name, type, value } = event.target;\n    const val = type === 'number' ? parseFloat(value) : value;\n    this.setState({ [name]: val });\n  };\n  \n  uploadFile = async e => {\n    const files = e.target.files;\n    const data = new FormData();\n    data.append('file', files[0]);\n    data.append('upload_preset', 'online-store');\n\n    const res = await fetch\n      ('https://api.cloudinary.com/v1_1/rad1/image/upload', {\n        method: 'POST',\n        body: data\n      });\n      const file = await res.json();\n      console.log(file);\n      this.setState({\n        image: file.secure_url,\n        largeImage: file.eager[0].secure_url\n      });\n  }\n  render() {\n    return (\n      <Mutation mutation={CREATE_ITEM_MUTATION} variables={this.state}>\n        {(createItem, {loading, error}) => (\n\n      <Form onSubmit={async e => {\n        // Stop the form from submitting \n        e.preventDefault();\n        // call the mutation\n        const res = await createItem();\n        // Change them to the single item page\n        console.log(res);\n        Router.push({\n          pathname: '/item',\n          query: { id: res.data.createItem.id },\n        });\n      }}>\n        <Error error={error} />\n        <fieldset disabled={loading} aria-busy={loading}>\n        <label htmlFor='file'>\n            Image\n            <input \n              type='file'\n              id='title'\n              name='title'\n              placeholder='Upload an image'\n              required\n              onChange={this.uploadFile}\n              />\n              {this.state.image && (\n                <img width=\"200\" src={this.state.image} \n                alt=\"Upload Preview\" />\n              )}\n          </label>\n\n          <label htmlFor='title'>\n            Title\n            <input \n              type='text'\n              id='title'\n              name='title'\n              placeholder='Title'\n              required\n              value={this.state.title}\n              onChange={this.handleChange}\n              />\n          </label>\n\n          <label htmlFor='price'>\n            price\n            <input \n              type='text'\n              id='price'\n              name='price'\n              placeholder='price'\n              required\n              value={this.state.price}\n              onChange={this.handleChange}\n              />\n          </label>\n\n          <label htmlFor='description'>\n            Description\n            <textarea \n              id='description'\n              name='description'\n              placeholder='Enter a description'\n              required\n              value={this.state.description}\n              onChange={this.handleChange}\n              />\n          </label>\n          <button type=\"submit\">Submit</button>\n        </fieldset>\n      </Form>\n\n      )}\n    </Mutation>\n    );\n  }\n}\n\nexport default CreateItem;\nexport { CREATE_ITEM_MUTATION };"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAmBA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAQA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAAA;AAQA;AACA;AAFA;AACA;AARA;AAMA;AANA;AAAA;AACA;AADA;AAWA;AACA;AACA;AAAA;AACA;AACA;AAFA;AACA;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;AAiBA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AACA;AADA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAFA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AArEA;AA4EA;;;;AAjHA;AACA;AAmHA;;;;;A","sourceRoot":""}